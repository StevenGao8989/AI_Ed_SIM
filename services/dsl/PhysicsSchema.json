{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "PhysicsDSL Schema",
  "description": "中国初一到高三物理内容的结构化定义，覆盖95%的物理知识点",
  "type": "object",
  "required": ["metadata", "system", "initialConditions", "constraints", "simulation", "output"],
  "properties": {
    "metadata": {
      "type": "object",
      "required": ["title", "subject", "grade", "difficulty", "topics"],
      "properties": {
        "title": {
          "type": "string",
          "description": "题目标题"
        },
        "subject": {
          "type": "string",
          "enum": ["physics"],
          "description": "学科类型"
        },
        "grade": {
          "type": "string",
          "enum": ["junior1", "junior2", "junior3", "senior1", "senior2", "senior3"],
          "description": "年级：初一、初二、初三、高一、高二、高三"
        },
        "difficulty": {
          "type": "string",
          "enum": ["easy", "medium", "hard", "expert"],
          "description": "难度等级"
        },
        "topics": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "相关知识点标签"
        },
        "description": {
          "type": "string",
          "description": "题目描述"
        },
        "author": {
          "type": "string",
          "description": "题目作者"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "创建时间"
        }
      }
    },
    "system": {
      "type": "object",
      "required": ["type", "dimensions", "coordinateSystem"],
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "kinematics_linear", "kinematics_2d", "kinematics_circular",
            "dynamics_newton", "dynamics_energy", "dynamics_momentum",
            "thermodynamics", "fluid_mechanics", "wave_motion",
            "electrostatics", "electromagnetism", "electric_circuit",
            "optics_geometric", "optics_wave", "atomic_physics",
            "nuclear_physics", "quantum_physics"
          ],
          "description": "物理系统类型"
        },
        "dimensions": {
          "type": "integer",
          "minimum": 1,
          "maximum": 3,
          "description": "空间维度：1D、2D、3D"
        },
        "coordinateSystem": {
          "type": "string",
          "enum": ["cartesian", "polar", "spherical", "cylindrical"],
          "description": "坐标系类型"
        },
        "gravity": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "是否考虑重力"
            },
            "direction": {
              "type": "string",
              "enum": ["down", "up", "left", "right", "custom"],
              "description": "重力方向"
            },
            "magnitude": {
              "type": "number",
              "description": "重力大小 (m/s²)"
            }
          }
        },
        "friction": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "是否考虑摩擦力"
            },
            "coefficient": {
              "type": "number",
              "description": "摩擦系数"
            },
            "type": {
              "type": "string",
              "enum": ["static", "kinetic", "rolling"],
              "description": "摩擦类型"
            }
          }
        },
        "airResistance": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "是否考虑空气阻力"
            },
            "coefficient": {
              "type": "number",
              "description": "阻力系数"
            }
          }
        }
      }
    },
    "objects": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["id", "type", "position", "mass"],
        "properties": {
          "id": {
            "type": "string",
            "description": "对象唯一标识符"
          },
          "type": {
            "type": "string",
            "enum": [
              "particle", "rigid_body", "spring", "pendulum", "pulley",
              "inclined_plane", "circular_track", "electric_charge",
              "magnetic_field", "lens", "mirror", "wave_source"
            ],
            "description": "对象类型"
          },
          "position": {
            "type": "object",
            "required": ["x", "y"],
            "properties": {
              "x": {
                "type": "number",
                "description": "X坐标"
              },
              "y": {
                "type": "number",
                "description": "Y坐标"
              },
              "z": {
                "type": "number",
                "description": "Z坐标（3D系统）"
              }
            }
          },
          "velocity": {
            "type": "object",
            "properties": {
              "x": {
                "type": "number",
                "description": "X方向速度"
              },
              "y": {
                "type": "number",
                "description": "Y方向速度"
              },
              "z": {
                "type": "number",
                "description": "Z方向速度"
              }
            }
          },
          "acceleration": {
            "type": "object",
            "properties": {
              "x": {
                "type": "number",
                "description": "X方向加速度"
              },
              "y": {
                "type": "number",
                "description": "Y方向加速度"
              },
              "z": {
                "type": "number",
                "description": "Z方向加速度"
              }
            }
          },
          "mass": {
            "type": "number",
            "minimum": 0,
            "description": "质量 (kg)"
          },
          "charge": {
            "type": "number",
            "description": "电荷量 (C)"
          },
          "radius": {
            "type": "number",
            "minimum": 0,
            "description": "半径 (m)"
          },
          "length": {
            "type": "number",
            "minimum": 0,
            "description": "长度 (m)"
          },
          "width": {
            "type": "number",
            "minimum": 0,
            "description": "宽度 (m)"
          },
          "height": {
            "type": "number",
            "minimum": 0,
            "description": "高度 (m)"
          },
          "elasticity": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "弹性系数"
          },
          "material": {
            "type": "string",
            "enum": [
              "steel", "aluminum", "copper", "wood", "plastic",
              "glass", "rubber", "water", "air", "vacuum"
            ],
            "description": "材料类型"
          },
          "properties": {
            "type": "object",
            "description": "对象特定属性",
            "additionalProperties": true
          }
        }
      }
    },
    "initialConditions": {
      "type": "object",
      "properties": {
        "time": {
          "type": "number",
          "default": 0,
          "description": "初始时间 (s)"
        },
        "positions": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["objectId", "position"],
            "properties": {
              "objectId": {
                "type": "string",
                "description": "对象ID"
              },
              "position": {
                "type": "object",
                "required": ["x", "y"],
                "properties": {
                  "x": {
                    "type": "number",
                    "description": "X坐标"
                  },
                  "y": {
                    "type": "number",
                    "description": "Y坐标"
                  },
                  "z": {
                    "type": "number",
                    "description": "Z坐标"
                  }
                }
              }
            }
          }
        },
        "velocities": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["objectId", "velocity"],
            "properties": {
              "objectId": {
                "type": "string",
                "description": "对象ID"
              },
              "velocity": {
                "type": "object",
                "required": ["x", "y"],
                "properties": {
                  "x": {
                    "type": "number",
                    "description": "X方向速度"
                  },
                  "y": {
                    "type": "number",
                    "description": "Y方向速度"
                  },
                  "z": {
                    "type": "number",
                    "description": "Z方向速度"
                  }
                }
              }
            }
          }
        },
        "energies": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["objectId", "type", "value"],
            "properties": {
              "objectId": {
                "type": "string",
                "description": "对象ID"
              },
              "type": {
                "type": "string",
                "enum": ["kinetic", "potential", "thermal", "electrical", "magnetic"],
                "description": "能量类型"
              },
              "value": {
                "type": "number",
                "description": "能量值 (J)"
              }
            }
          }
        }
      }
    },
    "constraints": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["type", "objects"],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "distance", "angle", "velocity", "acceleration", "force",
              "energy", "momentum", "charge", "current", "voltage",
              "temperature", "pressure", "wavelength", "frequency"
            ],
            "description": "约束类型"
          },
          "objects": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "涉及的对象ID列表"
          },
          "value": {
            "type": "number",
            "description": "约束值"
          },
          "unit": {
            "type": "string",
            "description": "约束值单位"
          },
          "relation": {
            "type": "string",
            "enum": ["=", "<", ">", "<=", ">=", "!="],
            "description": "约束关系"
          },
          "description": {
            "type": "string",
            "description": "约束描述"
          }
        }
      }
    },
    "forces": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["type", "objects"],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "gravitational", "electromagnetic", "nuclear_strong", "nuclear_weak",
              "friction", "normal", "tension", "spring", "buoyant",
              "drag", "centripetal", "coriolis", "lorentz"
            ],
            "description": "力类型"
          },
          "objects": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "施力对象和受力对象ID"
          },
          "magnitude": {
            "type": "number",
            "description": "力的大小 (N)"
          },
          "direction": {
            "type": "object",
            "properties": {
              "angle": {
                "type": "number",
                "description": "方向角度 (度)"
              },
              "x": {
                "type": "number",
                "description": "X方向分量"
              },
              "y": {
                "type": "number",
                "description": "Y方向分量"
              },
              "z": {
                "type": "number",
                "description": "Z方向分量"
              }
            }
          },
          "position": {
            "type": "object",
            "properties": {
              "x": {
                "type": "number",
                "description": "作用点X坐标"
              },
              "y": {
                "type": "number",
                "description": "作用点Y坐标"
              },
              "z": {
                "type": "number",
                "description": "作用点Z坐标"
              }
            }
          },
          "timeDependent": {
            "type": "boolean",
            "description": "是否随时间变化"
          },
          "function": {
            "type": "string",
            "description": "力的时间函数表达式"
          }
        }
      }
    },
    "fields": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["type", "region"],
        "properties": {
          "type": {
            "type": "string",
            "enum": ["gravitational", "electric", "magnetic", "electromagnetic"],
            "description": "场类型"
          },
          "region": {
            "type": "object",
            "required": ["type", "parameters"],
            "properties": {
              "type": {
                "type": "string",
                "enum": ["rectangle", "circle", "sphere", "cylinder", "custom"],
                "description": "区域形状"
              },
              "parameters": {
                "type": "object",
                "description": "区域参数"
              }
            }
          },
          "strength": {
            "type": "number",
            "description": "场强"
          },
          "direction": {
            "type": "string",
            "enum": ["radial", "uniform", "custom"],
            "description": "场方向"
          },
          "gradient": {
            "type": "number",
            "description": "场梯度"
          }
        }
      }
    },
    "constants": {
      "type": "object",
      "properties": {
        "universal": {
          "type": "object",
          "properties": {
            "gravitationalConstant": {
              "type": "number",
              "default": 6.67430e-11,
              "description": "万有引力常数 (N⋅m²/kg²)"
            },
            "speedOfLight": {
              "type": "number",
              "default": 299792458,
              "description": "光速 (m/s)"
            },
            "planckConstant": {
              "type": "number",
              "default": 6.62607015e-34,
              "description": "普朗克常数 (J⋅s)"
            },
            "boltzmannConstant": {
              "type": "number",
              "default": 1.380649e-23,
              "description": "玻尔兹曼常数 (J/K)"
            },
            "elementaryCharge": {
              "type": "number",
              "default": 1.602176634e-19,
              "description": "基本电荷 (C)"
            }
          }
        },
        "earth": {
          "type": "object",
          "properties": {
            "gravity": {
              "type": "number",
              "default": 9.80665,
              "description": "地球重力加速度 (m/s²)"
            },
            "mass": {
              "type": "number",
              "default": 5.972e24,
              "description": "地球质量 (kg)"
            },
            "radius": {
              "type": "number",
              "default": 6371000,
              "description": "地球半径 (m)"
            }
          }
        },
        "custom": {
          "type": "object",
          "description": "自定义常数",
          "additionalProperties": {
            "type": "number"
          }
        }
      }
    },
    "simulation": {
      "type": "object",
      "required": ["timeStep", "duration", "method"],
      "properties": {
        "timeStep": {
          "type": "number",
          "minimum": 0.001,
          "description": "时间步长 (s)"
        },
        "duration": {
          "type": "number",
          "minimum": 0.1,
          "description": "仿真总时长 (s)"
        },
        "method": {
          "type": "string",
          "enum": ["euler", "runge_kutta_4", "verlet", "leapfrog"],
          "description": "数值积分方法"
        },
        "precision": {
          "type": "number",
          "minimum": 1e-10,
          "description": "计算精度"
        },
        "adaptive": {
          "type": "boolean",
          "description": "是否使用自适应时间步长"
        },
        "collisionDetection": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "是否启用碰撞检测"
            },
            "method": {
              "type": "string",
              "enum": ["broad_phase", "narrow_phase", "continuous"],
              "description": "碰撞检测方法"
            },
            "resolution": {
              "type": "string",
              "enum": ["penalty", "impulse", "position"],
              "description": "碰撞分辨率方法"
            }
          }
        },
        "energyConservation": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "是否检查能量守恒"
            },
            "tolerance": {
              "type": "number",
              "description": "能量守恒容差"
            }
          }
        }
      }
    },
    "output": {
      "type": "object",
      "required": ["format", "variables"],
      "properties": {
        "format": {
          "type": "string",
          "enum": ["json", "csv", "excel", "matlab"],
          "description": "输出格式"
        },
        "variables": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "position", "velocity", "acceleration", "force", "energy",
              "momentum", "angular_momentum", "torque", "power",
              "temperature", "pressure", "volume", "entropy",
              "electric_field", "magnetic_field", "voltage", "current",
              "resistance", "capacitance", "inductance"
            ]
          },
          "description": "需要输出的变量列表"
        },
        "samplingRate": {
          "type": "number",
          "minimum": 1,
          "description": "采样频率 (Hz)"
        },
        "visualization": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "是否启用可视化"
            },
            "type": {
              "type": "string",
              "enum": ["trajectory", "phase_space", "energy_time", "force_diagram"],
              "description": "可视化类型"
            },
            "realTime": {
              "type": "boolean",
              "description": "是否实时显示"
            },
            "frameRate": {
              "type": "number",
              "minimum": 1,
              "description": "帧率 (fps)"
            }
          }
        },
        "export": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "是否导出结果"
            },
            "path": {
              "type": "string",
              "description": "导出路径"
            },
            "includeMetadata": {
              "type": "boolean",
              "description": "是否包含元数据"
            }
          }
        }
      }
    },
    "validation": {
      "type": "object",
      "properties": {
        "dimensionalAnalysis": {
          "type": "boolean",
          "description": "是否进行量纲分析"
        },
        "physicalConstraints": {
          "type": "boolean",
          "description": "是否检查物理约束"
        },
        "numericalStability": {
          "type": "boolean",
          "description": "是否检查数值稳定性"
        },
        "energyConservation": {
          "type": "boolean",
          "description": "是否检查能量守恒"
        },
        "momentumConservation": {
          "type": "boolean",
          "description": "是否检查动量守恒"
        },
        "chargeConservation": {
          "type": "boolean",
          "description": "是否检查电荷守恒"
        }
      }
    },
    "extensions": {
      "type": "object",
      "description": "扩展属性，用于特定物理问题的额外配置",
      "additionalProperties": true
    }
  },
  "additionalProperties": false
}
