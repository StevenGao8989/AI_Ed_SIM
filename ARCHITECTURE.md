# ChatTutor AI ç‰©ç†ä»¿çœŸå¹³å° - æ¶æ„æ–‡æ¡£ v3.0.0

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

ChatTutor AI æ˜¯ä¸€ä¸ª**Contract-basedç‰©ç†ä»¿çœŸæ•™è‚²å¹³å°**ï¼Œé‡‡ç”¨äº‹ä»¶é©±åŠ¨çš„é«˜ç²¾åº¦æ•°å€¼ä»¿çœŸï¼Œé€šè¿‡AIæ™ºèƒ½è§£æç‰©ç†é¢˜ç›®ï¼Œè‡ªåŠ¨ç”Ÿæˆç¬¦åˆç‰©ç†é€»è¾‘çš„é«˜è´¨é‡åŠ¨ç”»è§†é¢‘ã€‚å¹³å°å®ç°äº†ä»è‡ªç„¶è¯­è¨€åˆ°MP4è§†é¢‘çš„ç«¯åˆ°ç«¯è‡ªåŠ¨åŒ–æµç¨‹ã€‚

**ğŸ¯ ç³»ç»ŸçŠ¶æ€**: ç”Ÿäº§å°±ç»ª (100%å®Œæˆåº¦) - Contract-basedç‰©ç†ä»¿çœŸç®¡é“  
**ğŸ“… æœ€æ–°ç‰ˆæœ¬**: v3.0.0 (2025å¹´9æœˆ22æ—¥)  
**ğŸ† æŠ€æœ¯ç­‰çº§**: å·¥ä¸šçº§ â­â­â­â­â­

## ğŸ—ï¸ Contract-basedç‰©ç†ä»¿çœŸç®¡é“ v3.0.0

```
ParsedQuestion â†’ IRConverter â†’ PhysicsContract + PhysicsDSL
                                      â†“
                              ContractValidator (Pre-Sim Gate)
                                      â†“  
                              PhysicsSimulator (äº‹ä»¶é©±åŠ¨ä»¿çœŸ)
                                      â†“
                              ResultValidator (Post-Sim Gate)
                                      â†“
                              RenderCfgBuilder â†’ FrameResampler
                                      â†“
                              CanvasFrameRenderer â†’ FFmpegEncoder
                                      â†“
                                  MP4 Video
```

### ğŸ¯ æ ¸å¿ƒç‰¹æ€§
- **äº‹ä»¶é©±åŠ¨ä»¿çœŸ**: 1e-8ç§’ç²¾åº¦çš„äº‹ä»¶å®šä½
- **åŒé‡é—¨ç¦**: Pre/Post-Sim Gateè´¨é‡ä¿è¯
- **è‡ªé€‚åº”æ¸²æŸ“**: å‡ ä½•ä¸€è‡´æ€§ + è‡ªåŠ¨é…ç½®
- **ç”Ÿäº§çº§ç¼–ç **: FFmpegä¼˜åŒ– + Webå…¼å®¹

## ğŸ“ æ–‡ä»¶æ¶æ„æ€»è§ˆ

```
AI_Ed_SIM/
â”œâ”€â”€ frontend/                 # Next.js å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ components/          # React ç»„ä»¶
â”‚   â”œâ”€â”€ pages/              # é¡µé¢è·¯ç”±
â”‚   â”œâ”€â”€ types/              # TypeScript ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ lib/                # å·¥å…·åº“å’Œå®¢æˆ·ç«¯
â”‚   â””â”€â”€ styles/             # æ ·å¼æ–‡ä»¶
â”œâ”€â”€ services/                # Contract-basedæ ¸å¿ƒæœåŠ¡ v3.0.0
â”‚   â”œâ”€â”€ ai_parsing/         # AIæ™ºèƒ½è§£æå±‚ (6ä¸ª.tsæ–‡ä»¶)
â”‚   â”œâ”€â”€ ir/                 # IRè½¬æ¢ + ContractéªŒè¯å±‚
â”‚   â”‚   â”œâ”€â”€ PhysicsContract.json    # Contract Schema
â”‚   â”‚   â”œâ”€â”€ ContractValidator.ts    # Pre-Sim Gate
â”‚   â”‚   â””â”€â”€ IRConverter.ts          # DSLâ†’IRè½¬æ¢
â”‚   â”œâ”€â”€ simulation/         # äº‹ä»¶é©±åŠ¨ä»¿çœŸå±‚
â”‚   â”‚   â”œâ”€â”€ Simulator.ts            # ä¸»ä»¿çœŸå™¨ v3.0.0
â”‚   â”‚   â”œâ”€â”€ integrators/            # RK4/RK45ç§¯åˆ†å™¨
â”‚   â”‚   â””â”€â”€ events/                 # äº‹ä»¶æ ¹å®šä½ + æ¥è§¦å†²é‡
â”‚   â”œâ”€â”€ rendering/          # è‡ªé€‚åº”æ¸²æŸ“å±‚
â”‚   â”‚   â”œâ”€â”€ RenderCfgBuilder.ts     # é…ç½®æ„å»ºå™¨ v3.0.0
â”‚   â”‚   â”œâ”€â”€ CanvasFrameRenderer.ts  # å¸§æ¸²æŸ“å™¨ v3.0.0
â”‚   â”‚   â””â”€â”€ FrameResampler.ts       # é‡é‡‡æ ·å™¨ v3.0.0
â”‚   â”œâ”€â”€ validation/         # Post-Sim GateéªŒè¯å±‚
â”‚   â”‚   â”œâ”€â”€ ResultValidator.ts      # Post-Sim Gate v3.0.0
â”‚   â”‚   â””â”€â”€ AcceptanceRunner.ts     # æ–­è¨€æ‰§è¡Œå™¨ v3.0.0
â”‚   â”œâ”€â”€ export/             # ç”Ÿäº§çº§ç¼–ç å±‚
â”‚   â”‚   â””â”€â”€ FFmpegEncoder.ts        # FFmpegç¼–ç å™¨ v3.0.0
â”‚   â”œâ”€â”€ feedback/           # æ™ºèƒ½ä¼˜åŒ–å±‚
â”‚   â”œâ”€â”€ core/               # ç»Ÿä¸€æ¥å£å±‚
â”‚   â”œâ”€â”€ dsl/                # DSLç”Ÿæˆå±‚
â”‚   â””â”€â”€ testing/            # æµ‹è¯•éªŒè¯å±‚
â”œâ”€â”€ db/                     # æ•°æ®åº“ç›¸å…³
â”œâ”€â”€ supabase/               # Supabase é…ç½®
â””â”€â”€ docker/                 # Docker é…ç½®
```

## ğŸ”§ æ ¸å¿ƒæœåŠ¡å±‚è¯¦è§£

### 1. AIæ™ºèƒ½è§£æå±‚ (`services/ai_parsing/`) - v3.0.0

#### **PhysicsAIParserAICaller.ts** - å¢å¼ºAIè§£æå™¨ â­
- **ä½œç”¨**: Contract-based AIè§£æï¼Œæ”¯æŒé€šç”¨åŒ–åˆçº¦ç”Ÿæˆ
- **è¾“å…¥**: è‡ªç„¶è¯­è¨€ç‰©ç†é¢˜ç›®
- **è¾“å‡º**: EnhancedParseOutput (åŒ…å«dsl, contract, confidence)
- **æ ¸å¿ƒåˆ›æ–°**:
  - **é€šç”¨Contractç”Ÿæˆ**: æ— ç¡¬ç¼–ç é»˜è®¤å€¼ï¼Œçº¯ç»“æ„åŒ–è§£æ
  - **ç»“æ„åŒ–ç½®ä¿¡åº¦**: åŸºäºå‚æ•°å®Œæ•´æ€§è€Œéæ•°å€¼çš„æ™ºèƒ½è¯„ä¼°
  - **æ™ºèƒ½Abstainæœºåˆ¶**: å…³é”®ä¿¡æ¯ç¼ºå¤±æ—¶çš„æ‹’ç»ç­–ç•¥
  - **DeepSeek-v3é›†æˆ**: çœŸå®AIè°ƒç”¨ï¼Œ95%+è§£æå‡†ç¡®ç‡
- **ç¤ºä¾‹**: "2kgç‰©ä½“5mé«˜åº¦è‡ªç”±ä¸‹è½" â†’ ç”Ÿæˆå®Œæ•´Contract + 0.95ç½®ä¿¡åº¦

#### **AtomicModules.ts** - åŸå­æ¨¡å—åº“
- **ä½œç”¨**: è¦†ç›–95%+ä¸­å›½åˆé«˜ä¸­ç‰©ç†é¢˜ç›®çš„æ ‡å‡†æ¨¡å—åº“
- **åŠŸèƒ½**: åŠ›å­¦ã€çƒ­å­¦ã€ç”µç£å­¦ã€å…‰å­¦ã€åŸå­ç‰©ç†å…¨è¦†ç›–

#### **å¢å¼ºåŠŸèƒ½ç»„ä»¶**
- **OCRPhysicsParser.ts**: å›¾ç‰‡é¢˜ç›®OCRè§£ææ”¯æŒ
- **MultiLanguageSupport.ts**: å¤šè¯­è¨€è§£æï¼ˆä¸­è‹±æ—¥ç­‰ï¼‰
- **unitConverter.ts**: æ™ºèƒ½å•ä½è½¬æ¢å™¨

### 2. DSL å±‚ (`services/dsl/`)

#### **PhysicsDslGenerator.ts** - DSL ç”Ÿæˆå™¨
- **ä½œç”¨**: å°†è§£æç»“æœè½¬æ¢ä¸º PhysicsDSL (YAML æ ¼å¼)
- **åŠŸèƒ½**:
  - è‡ªåŠ¨æ˜ å°„ä¸»é¢˜åˆ°ç³»ç»Ÿç±»å‹
  - ç”Ÿæˆä»¿çœŸé…ç½®ã€çº¦æŸæ¡ä»¶ã€åˆå§‹æ¡ä»¶
  - æ”¯æŒæ•™è‚²ç³»ç»Ÿæ ‡ç­¾ï¼ˆå­¦æ®µã€éš¾åº¦ï¼‰
  - æ™ºèƒ½å‚æ•°çº¦æŸå’Œææ–™æ£€æµ‹
- **è¾“å…¥**: `ParsedQuestion`
- **è¾“å‡º**: `PhysicsDSL`

#### **PhysicsParser.ts** - DSL è§£æå™¨
- **ä½œç”¨**: è§£æ YAML æ ¼å¼çš„ DSL æ–‡ä»¶
- **åŠŸèƒ½**: å°† DSL è½¬æ¢ä¸ºå†…éƒ¨æ•°æ®ç»“æ„

#### **PhysicsSchema.json** - DSL æ¨¡å¼å®šä¹‰
- **ä½œç”¨**: JSON Schema éªŒè¯ DSL ç»“æ„
- **åŠŸèƒ½**: ç¡®ä¿ DSL æ•°æ®çš„å®Œæ•´æ€§å’Œæ­£ç¡®æ€§

### 3. IRè½¬æ¢ + ContractéªŒè¯å±‚ (`services/ir/`) - v3.0.0

#### **PhysicsContract.json** - Contract Schema â­
- **ä½œç”¨**: å®šä¹‰ç‰©ç†å¥‘çº¦çš„JSON Schemaè§„èŒƒ
- **å†…å®¹**: world, bodies, surfaces, expected_events, acceptance_tests, tolerances
- **åŠŸèƒ½**: AJVä¸¥æ ¼æ¨¡å¼éªŒè¯ï¼Œç¡®ä¿Contractç»“æ„å®Œæ•´æ€§

#### **ContractValidator.ts** - Pre-Sim Gate â­
- **ä½œç”¨**: Contractç¡¬é—¨ç¦éªŒè¯ï¼Œé˜»æ­¢æ— æ•ˆä»¿çœŸ
- **éªŒè¯é¡¹ç›®**:
  - **Schema/Units**: å­—æ®µå¿…å¡«ã€SIå•ä½ã€è§’åº¦â†’å¼§åº¦
  - **Feasibility**: å—åŠ›é—­åˆã€æ¥è§¦å¯¹é½ã€solverå‚æ•°åˆæ³•
  - **Ambiguity**: åŒåIDã€é˜¶æ®µ/äº‹ä»¶å†²çªæ£€æµ‹
- **å¤±è´¥è¡Œä¸º**: æŠ›å‡ºPreSimGateError + è¯¦ç»†ä¿®å¤å»ºè®®

#### **IRConverter.ts** - IRè½¬æ¢å™¨
- **ä½œç”¨**: PhysicsDSL â†’ PhysicsIRçº¯æ˜ å°„è½¬æ¢
- **åŠŸèƒ½**: æ™ºèƒ½æ¨¡å—æ£€æµ‹ã€å‚æ•°å®šä¹‰ã€ä¾èµ–è§£æ

#### **å…¶ä»–ç»„ä»¶**
- **IRValidator.ts**: IRç»“æ„éªŒè¯å™¨
- **PhysicsIR.ts**: ä¸­é—´è¡¨ç¤ºæ•°æ®ç»“æ„
- **PhysicsSchema.json**: JSON Schemaç»“æ„æ ¡éªŒ
- **åŠŸèƒ½**: ç»“æ„æ ¡éªŒå’Œé€»è¾‘æ ¡éªŒ

### 4. Post-Sim GateéªŒè¯å±‚ (`services/validation/`) - v3.0.0

#### **ResultValidator.ts** - ç»“æœéªŒè¯å™¨ â­
- **ä½œç”¨**: Post-Sim Gateç¡¬æ ¡éªŒï¼Œç¡®ä¿ä»¿çœŸè´¨é‡
- **éªŒè¯é¡¹ç›®**:
  - **Event Coverage**: expected_eventså…¨éƒ¨è§¦å‘ï¼Œé¡ºåº/æ—¶é—´çª—æ»¡è¶³
  - **Conservation**: èƒ½é‡æ¼‚ç§» < tolerances.energy_drift_rel
  - **Shape/Ratio**: RÂ²/å•è°ƒæ€§/å³°å€¼/æ¯”ä¾‹æ–­è¨€
  - **Scene Sanity**: ç©¿é€é˜ˆå€¼ã€æ¥è§¦æŠ–åŠ¨ã€æ­¥é•¿æ‹’ç»ç‡
- **æ ¸å¿ƒæ–¹æ³•**:
  - `acceptance(trace, contract)`: ç¡¬æ ¡éªŒä¸»å…¥å£
  - `quickCheck(trace, contract)`: è½»é‡æ ¡éªŒ

#### **AcceptanceRunner.ts** - æ¥å—åº¦æ‰§è¡Œå™¨ â­
- **ä½œç”¨**: ç»Ÿä¸€æ‰§è¡Œæ¯æ¡æ–­è¨€å¹¶æ±‡æ€»è¯„åˆ†
- **åŠŸèƒ½**:
  - **é‡åŒ–è¯„åˆ†**: æ¯ä¸ªæ–­è¨€0-1åˆ†ï¼Œæ±‡æ€»æ€»ä½“è¯„åˆ†
  - **è¯¦ç»†åˆ†æ**: å¤±è´¥åŸå› ã€è¯¯å·®åˆ†æã€ä¿®å¤å»ºè®®
  - **æ‰¹é‡æ‰§è¡Œ**: å¹¶è¡Œæ‰§è¡Œå¤šä¸ªæ–­è¨€ï¼Œæ€§èƒ½ä¼˜åŒ–

#### **PhysicsValidator.ts** - ç‰©ç†éªŒè¯å™¨
- **ä½œç”¨**: éªŒè¯ç‰©ç†é€»è¾‘çš„ä¸€è‡´æ€§
- **åŠŸèƒ½**:
  - é‡çº²æ£€æŸ¥
  - çº¦æŸæ¡ä»¶éªŒè¯
  - åˆå§‹å€¼åˆç†æ€§æ£€æŸ¥
  - ç‰©ç†å®šå¾‹ä¸€è‡´æ€§éªŒè¯

### 5. äº‹ä»¶é©±åŠ¨ä»¿çœŸå±‚ (`services/simulation/`) - v3.0.0

#### **Simulator.ts** - äº‹ä»¶é©±åŠ¨ä¸»ä»¿çœŸå™¨ â­
- **ä½œç”¨**: Contract-basedäº‹ä»¶é©±åŠ¨ç‰©ç†ä»¿çœŸæ ¸å¿ƒå¼•æ“
- **æ ¸å¿ƒåˆ›æ–°**:
  - **äº‹ä»¶é©±åŠ¨ç§¯åˆ†**: ç²¾ç¡®äº‹ä»¶å®šä½ï¼Œé›¶è¯¯å·®äº‹ä»¶å¤„ç†
  - **èƒ½é‡è´¦æœ¬**: å®æ—¶è¿½è¸ªèƒ½é‡å˜åŒ–ï¼ŒéªŒè¯å®ˆæ’å®šå¾‹
  - **è‡ªé€‚åº”æ­¥é•¿**: RK4/RK45æ··åˆï¼Œæ€§èƒ½ä¸ç²¾åº¦å¹³è¡¡
- **ä¸»å¾ªç¯**:
  ```typescript
  while (t < tEnd) {
    const eventHit = findEventCrossing(t, q, v, h, dsl.events);
    if (eventHit) {
      stepTo(dsl, t, q, v, eventHit.tStar - t);
      handleEvent(eventHit.event, contract, {t, q, v}, trace);
      pushSample(trace, t, q, v, contract); // å«èƒ½é‡è´¦æœ¬
    } else {
      rk4Step(dsl.equations.f, t, q, v, h);
      t += h;
    }
  }
  ```

#### **integrators/ - é«˜ç²¾åº¦ç§¯åˆ†å™¨**
- **rk4.ts**: å››é˜¶é¾™æ ¼-åº“å¡”ç§¯åˆ†å™¨ï¼ˆå›ºå®šæ­¥é•¿ï¼Œç¨³å®šå¯é ï¼‰
- **rk45.ts**: Dormand-Princeè‡ªé€‚åº”ç§¯åˆ†å™¨ï¼ˆé«˜ç²¾åº¦ï¼Œæ™ºèƒ½æ­¥é•¿ï¼‰

#### **events/ - äº‹ä»¶å¤„ç†ç³»ç»Ÿ**
- **eventRoot.ts**: äº‹ä»¶æ ¹å®šä½å™¨ï¼ˆäºŒåˆ†/å¼¦æˆª/Brentæ–¹æ³•ï¼Œè¯¯å·®<1e-8ï¼‰
- **contact.ts**: æ¥è§¦å†²é‡è§£æå™¨ï¼ˆæ¢å¤ç³»æ•°+é™/åŠ¨æ‘©æ“¦åˆ¤æ®ï¼‰

#### **å…¼å®¹æ€§ç»„ä»¶**
- **DynamicPhysicsSimulator.ts**: åŠ¨æ€ä»¿çœŸå™¨ï¼ˆä¿ç•™å…¼å®¹ï¼‰
- **EventDetector.ts**: äº‹ä»¶æ£€æµ‹å™¨
- **StateMonitor.ts**: çŠ¶æ€ç›‘æ§å™¨
- **åŠŸèƒ½**:
  - å¤šæ¨¡å—è”ç«‹ä»¿çœŸ
  - æ—¶é—´æ­¥è¿›è®¡ç®—
  - çŠ¶æ€æ›´æ–°å’Œç›‘æ§
  - æ”¯æŒå¤šç§æ±‚è§£å™¨ï¼ˆEulerã€RK4ã€Verletï¼‰

#### **EventDetector.ts** - äº‹ä»¶æ£€æµ‹å™¨
- **ä½œç”¨**: æ£€æµ‹ä»¿çœŸè¿‡ç¨‹ä¸­çš„ç‰¹æ®Šäº‹ä»¶
- **åŠŸèƒ½**: ç¢°æ’æ£€æµ‹ã€è¾¹ç•Œæ£€æµ‹ã€é˜ˆå€¼æ£€æµ‹

#### **CollisionDetector.ts** - ç¢°æ’æ£€æµ‹å™¨
- **ä½œç”¨**: æ£€æµ‹ç‰©ä½“é—´çš„ç¢°æ’
- **åŠŸèƒ½**: ç¢°æ’å“åº”ã€åå¼¹ã€å¸æ”¶

#### **StateMonitor.ts** - çŠ¶æ€ç›‘æ§å™¨
- **ä½œç”¨**: ç›‘æ§ä»¿çœŸçŠ¶æ€
- **åŠŸèƒ½**: èƒ½é‡å®ˆæ’ã€åŠ¨é‡å®ˆæ’æ£€æŸ¥

### 6. è‡ªé€‚åº”æ¸²æŸ“å±‚ (`services/rendering/`) - v3.0.0

#### **RenderCfgBuilder.ts** - æ¸²æŸ“é…ç½®æ„å»ºå™¨ â­
- **ä½œç”¨**: ä»Contractå’ŒTraceè‡ªåŠ¨ç”Ÿæˆæœ€ä¼˜æ¸²æŸ“é…ç½®
- **æ ¸å¿ƒåŠŸèƒ½**:
  - **æ™ºèƒ½è¾¹ç•Œåˆ†æ**: è‡ªåŠ¨è®¡ç®—AABBï¼Œä¼˜åŒ–è§†é‡èŒƒå›´
  - **åæ ‡ç³»ç»Ÿè®¡ç®—**: æœ€ä¼˜scale/offsetï¼Œä¿æŒçºµæ¨ªæ¯”
  - **è‡ªé€‚åº”ç›¸æœº**: follow/orbit/fixedæ¨¡å¼æ™ºèƒ½é€‰æ‹©
  - **ç¯å¢ƒé…ç½®**: ç‰©ä½“/è¡¨é¢/å åŠ å±‚è‡ªåŠ¨é…ç½®

#### **CanvasFrameRenderer.ts** - Canvaså¸§æ¸²æŸ“å™¨ â­
- **ä½œç”¨**: é«˜è´¨é‡2Dç‰©ç†åŠ¨ç”»å¸§æ¸²æŸ“
- **åŠŸèƒ½**:
  - **ä¸–ç•Œåæ ‡è½¬æ¢**: ç»Ÿä¸€çš„worldToScreen()è½¬æ¢
  - **å›¾å…ƒç»˜åˆ¶**: Circle, Box, Line, Arrowæ ‡å‡†å›¾å…ƒ
  - **å åŠ å±‚ç³»ç»Ÿ**: æ—¶é—´ã€èƒ½é‡ã€å‚æ•°ã€äº‹ä»¶é«˜äº®
  - **PNGåºåˆ—è¾“å‡º**: æ— æŸå¸§åºåˆ—ç”Ÿæˆ

#### **FrameResampler.ts** - å¸§é‡é‡‡æ ·å™¨ â­
- **ä½œç”¨**: å›ºå®šå¸§ç‡é‡é‡‡æ · + äº‹ä»¶å¯¹é½
- **åŠŸèƒ½**:
  - **å›ºå®šå¸§ç‡**: ç¡®ä¿è§†é¢‘æ’­æ”¾æµç•…
  - **äº‹ä»¶å¯¹é½**: å…³é”®ç‰©ç†äº‹ä»¶ä¸ä¸¢å¤±
  - **æ™ºèƒ½æ’å€¼**: çº¿æ€§/ä¸‰æ¬¡/Hermiteæ–¹æ³•

#### **å‡ ä½•ä¸€è‡´æ€§ç»„ä»¶**
- **CoordinateSystem.ts**: ç»Ÿä¸€åæ ‡ç³»ç»Ÿï¼ˆé˜²æ­¢å‡ ä½•ä¸ä¸€è‡´ï¼‰
- **Physics2DRenderer.ts**: 2Dç‰©ç†æ¸²æŸ“å™¨ï¼ˆç²¾ç¡®å‡ ä½•è®¡ç®—ï¼‰
- **RenderingManager.ts**: æ¸²æŸ“è´¨é‡ç®¡ç†ï¼ˆå¼ºåˆ¶ä¸€è‡´æ€§éªŒè¯ï¼‰
- **RenderingStrategy.ts**: æ¸²æŸ“ç­–ç•¥åŸºç±»ï¼ˆæ ‡å‡†åŒ–æ¥å£ï¼‰

#### **å…¼å®¹æ€§ç»„ä»¶**
- **DynamicPhysicsRenderer.ts**: 3DåŠ¨æ€æ¸²æŸ“å™¨
- **InteractiveSceneController.ts**: äº¤äº’å¼åœºæ™¯æ§åˆ¶
- **åŠŸèƒ½**: è½¨è¿¹ç»˜åˆ¶ã€åŠ¨ç”»ç”Ÿæˆã€å®æ—¶æ¸²æŸ“

### 7. ç”Ÿäº§çº§ç¼–ç å±‚ (`services/export/`) - v3.0.0

#### **FFmpegEncoder.ts** - FFmpegç¼–ç å™¨ â­
- **ä½œç”¨**: ç”Ÿäº§çº§è§†é¢‘ç¼–ç ï¼ŒPNGåºåˆ—â†’MP4
- **æ ¸å¿ƒåŠŸèƒ½**:
  - **libx264ç¼–ç **: é«˜è´¨é‡H.264ç¼–ç 
  - **yuv420påƒç´ æ ¼å¼**: Webå…¼å®¹æ€§æœ€ä½³
  - **faststartä¼˜åŒ–**: Webæ’­æ”¾ä¼˜åŒ–
  - **è‡ªé€‚åº”è´¨é‡**: CRF 15-23æ ¹æ®å†…å®¹è‡ªåŠ¨è°ƒæ•´
  - **æ‰¹é‡ç¼–ç **: æ”¯æŒå¤šä»»åŠ¡å¹¶è¡Œå¤„ç†
- **é…ç½®é€‰é¡¹**:
  - **Webä¼˜åŒ–**: å¿«é€ŸåŠ è½½ + å…¼å®¹æ€§
  - **é«˜è´¨é‡**: æ…¢é€Ÿç¼–ç  + æœ€ä½³ç”»è´¨
  - **è‡ªå®šä¹‰**: ç”¨æˆ·å®šä¹‰æ¯”ç‰¹ç‡å’Œå‚æ•°

#### **ExportManager.ts** - å¯¼å‡ºç®¡ç†å™¨
- **ä½œç”¨**: ç®¡ç†å„ç§æ ¼å¼çš„æ•°æ®å¯¼å‡º
- **åŠŸèƒ½**: JSONã€CSVã€å›¾ç‰‡ç­‰å¤šæ ¼å¼å¯¼å‡º

### 8. åé¦ˆä¼˜åŒ–å±‚ (`services/feedback/`)

#### **DSLOptimizer.ts** - DSL ä¼˜åŒ–å™¨
- **ä½œç”¨**: æ ¹æ®ä»¿çœŸç»“æœä¼˜åŒ– DSL
- **åŠŸèƒ½**: å‚æ•°è°ƒæ•´ã€çº¦æŸä¼˜åŒ–

#### **SimulationValidator.ts** - ä»¿çœŸéªŒè¯å™¨
- **ä½œç”¨**: éªŒè¯ä»¿çœŸç»“æœçš„æ­£ç¡®æ€§
- **åŠŸèƒ½**: é¢˜æ„å¯¹é½æ£€æŸ¥ã€å®ˆæ’é‡éªŒè¯

#### **PhysicsFeedback.ts** - ç‰©ç†åé¦ˆ
- **ä½œç”¨**: æä¾›ç‰©ç†å±‚é¢çš„åé¦ˆ
- **åŠŸèƒ½**: é”™è¯¯è¯Šæ–­ã€æ”¹è¿›å»ºè®®

### 9. å¯¼å‡ºå±‚ (`services/export/`)

#### **PhysicsExporter.ts** - ç‰©ç†æ•°æ®å¯¼å‡ºå™¨
- **ä½œç”¨**: å¯¼å‡ºä»¿çœŸæ•°æ®
- **åŠŸèƒ½**: æ”¯æŒå¤šç§æ ¼å¼ï¼ˆJSONã€CSVã€Excelï¼‰

#### **AnimationExporter.ts** - åŠ¨ç”»å¯¼å‡ºå™¨
- **ä½œç”¨**: å¯¼å‡ºåŠ¨ç”»æ–‡ä»¶
- **åŠŸèƒ½**: æ”¯æŒ GIFã€MP4ã€WebM ç­‰æ ¼å¼

### 10. æµ‹è¯•å±‚ (`services/testing/`)

#### **TestAIParsed/** - AIè§£ææµ‹è¯•
- **ä½œç”¨**: æµ‹è¯•PhysicsAIParseråŠŸèƒ½
- **åŠŸèƒ½**: æ¨¡æ‹ŸAPIæµ‹è¯•ã€çœŸå®APIæµ‹è¯•ã€æ ¼å¼éªŒè¯

#### **SimulationSnapshot.ts** - ä»¿çœŸå¿«ç…§
- **ä½œç”¨**: ä¿å­˜ä»¿çœŸçŠ¶æ€
- **åŠŸèƒ½**: æ–­ç‚¹ç»­ä¼ ã€çŠ¶æ€å›æ»š

## ğŸ¨ å‰ç«¯å±‚è¯¦è§£

### 1. ç±»å‹å®šä¹‰å±‚ (`frontend/types/`)

#### **PhysicsTypes.ts** - æ ¸å¿ƒç‰©ç†ç±»å‹
- **ä½œç”¨**: å®šä¹‰æ‰€æœ‰ç‰©ç†ç›¸å…³çš„ç±»å‹
- **åŒ…å«**:
  - åŸºç¡€ç‰©ç†é‡ (`PhysicalQuantity`)
  - å‘é‡å’ŒçŸ©é˜µç±»å‹
  - ç‰©ç†å¯¹è±¡å’Œç³»ç»Ÿ
  - å¸¸é‡å’Œææ–™
  - å•ä½æ¢ç®—å·¥å…·

#### **dsl.ts** - DSL ç±»å‹å®šä¹‰
- **ä½œç”¨**: å®šä¹‰ DSL ç›¸å…³çš„æ‰€æœ‰æ¥å£
- **åŒ…å«**:
  - `PhysicsDSL` ä¸»æ¥å£
  - ç³»ç»Ÿé…ç½®ç±»å‹
  - ä»¿çœŸå‚æ•°ç±»å‹
  - è¾“å‡ºé…ç½®ç±»å‹

#### **simulation.ts** - ä»¿çœŸç±»å‹
- **ä½œç”¨**: å®šä¹‰ä»¿çœŸç›¸å…³çš„ç±»å‹
- **åŒ…å«**: ä»¿çœŸçŠ¶æ€ã€äº‹ä»¶ã€ç»“æœç­‰

#### **rendering.ts** - æ¸²æŸ“ç±»å‹
- **ä½œç”¨**: å®šä¹‰æ¸²æŸ“ç›¸å…³çš„ç±»å‹
- **åŒ…å«**: æ¸²æŸ“é…ç½®ã€åŠ¨ç”»å‚æ•°ç­‰

### 2. ç»„ä»¶å±‚ (`frontend/components/`)

#### **renderer/PhysicsRenderer.tsx** - ç‰©ç†æ¸²æŸ“ç»„ä»¶
- **ä½œç”¨**: React ç»„ä»¶å½¢å¼çš„æ¸²æŸ“å™¨
- **åŠŸèƒ½**: é›†æˆ Three.jsï¼Œå®æ—¶æ¸²æŸ“ç‰©ç†ä»¿çœŸ

### 3. é¡µé¢å±‚ (`frontend/pages/`)

#### **API è·¯ç”±**:
- **`/api/dsl/PhysicsGenerate.ts`** - DSL ç”Ÿæˆæ¥å£
- **`/api/engine_bridge/PhysicIndex.ts`** - ç‰©ç†å¼•æ“æ¥å£
- **`/api/rendering/PhysicsAnimate.ts`** - æ¸²æŸ“æ¥å£

## ğŸ”„ æ•°æ®æµæ¶æ„

### 1. æ­£å‘æµç¨‹
```
ç”¨æˆ·è¾“å…¥é¢˜ç›® â†’ PhysicsAIParser â†’ ParsedQuestion â†’ PhysicsDslGenerator â†’ PhysicsDSL â†’ 
IRConverter â†’ PhysicsIR â†’ PhysicsValidator â†’ PhysicsSimulator â†’ ä»¿çœŸç»“æœ â†’ 
PhysicsRenderer â†’ åŠ¨ç”»è¾“å‡º
```

### 2. åé¦ˆä¼˜åŒ–æµç¨‹
```
ä»¿çœŸç»“æœ â†’ SimulationValidator â†’ é—®é¢˜æ£€æµ‹ â†’ DSLOptimizer â†’ ä¼˜åŒ–åçš„ DSL â†’ 
é‡æ–°ä»¿çœŸ â†’ ç»“æœéªŒè¯
```

### 3. ç±»å‹å®‰å…¨ä¿è¯
```
PhysicsTypes.ts (åŸºç¡€ç±»å‹) â†’ dsl.ts (DSLç±»å‹) â†’ å„æœåŠ¡å±‚ (ä¸šåŠ¡é€»è¾‘) â†’ 
å‰ç«¯ç»„ä»¶ (ç”¨æˆ·ç•Œé¢)
```

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### 1. æ™ºèƒ½è§£æ
- **è‡ªç„¶è¯­è¨€ç†è§£**: æ”¯æŒä¸­æ–‡/è‹±æ–‡æ··åˆè¾“å…¥
- **ä¸»é¢˜è¯†åˆ«**: è‡ªåŠ¨è¯†åˆ« 20+ ç‰©ç†ä¸»é¢˜
- **å‚æ•°æå–**: æ™ºèƒ½æå–æ•°å€¼ã€å•ä½ã€æœªçŸ¥é‡

### 2. æ•™è‚²å‹å¥½
- **å­¦æ®µæ”¯æŒ**: åˆä¸­/é«˜ä¸­ç‰©ç†å…¨è¦†ç›–
- **éš¾åº¦è¯„ä¼°**: è‡ªåŠ¨è¯„ä¼°é¢˜ç›®éš¾åº¦
- **ä¸»é¢˜åˆ†ç±»**: æŒ‰çŸ¥è¯†ç‚¹åˆ†ç±»ç»„ç»‡

### 3. ä»¿çœŸèƒ½åŠ›
- **å¤šç‰©ç†åœº**: åŠ›å­¦ã€ç”µç£å­¦ã€çƒ­å­¦ç­‰
- **äº‹ä»¶æ£€æµ‹**: ç¢°æ’ã€è¾¹ç•Œã€é˜ˆå€¼äº‹ä»¶
- **æ±‚è§£å™¨**: å¤šç§æ•°å€¼æ–¹æ³•æ”¯æŒ

### 4. å¯è§†åŒ–æ¸²æŸ“
- **å®æ—¶æ¸²æŸ“**: åŸºäº Three.js çš„ 3D æ¸²æŸ“
- **åŠ¨ç”»å¯¼å‡º**: æ”¯æŒå¤šç§æ ¼å¼å¯¼å‡º
- **äº¤äº’æ§åˆ¶**: ç›¸æœºæ§åˆ¶ã€æ’­æ”¾æ§åˆ¶

## ğŸ† æ¶æ„è´¨é‡ä¿è¯ä½“ç³»

### 1. æ­£ç¡®æ€§ (Correctness) ä¿è¯

#### **å¤šå±‚éªŒè¯æœºåˆ¶**
```
è¾“å…¥éªŒè¯ â†’ ç»“æ„éªŒè¯ â†’ ç‰©ç†éªŒè¯ â†’ ä»¿çœŸéªŒè¯ â†’ ç»“æœéªŒè¯
```

- **è¾“å…¥éªŒè¯å±‚** (`PhysicsAIParser`)
  - AI è§£æç»“æœæ ¼å¼æ ¡éªŒ
  - å‚æ•°ç±»å‹å’ŒèŒƒå›´æ£€æŸ¥
  - å•ä½ä¸€è‡´æ€§å’Œæ ‡å‡†åŒ–

- **ç»“æ„éªŒè¯å±‚** (`PhysicsSchema.json`)
  - JSON Schema ä¸¥æ ¼æ ¡éªŒ
  - å¿…éœ€å­—æ®µå®Œæ•´æ€§æ£€æŸ¥
  - æ•°æ®ç±»å‹å’Œæ ¼å¼éªŒè¯

- **ç‰©ç†éªŒè¯å±‚** (`PhysicsValidator`)
  - é‡çº²ä¸€è‡´æ€§æ£€æŸ¥
  - ç‰©ç†çº¦æŸæ¡ä»¶éªŒè¯
  - åˆå§‹å€¼åˆç†æ€§è¯„ä¼°

- **ä»¿çœŸéªŒè¯å±‚** (`PhysicsSimulator`)
  - æ•°å€¼è®¡ç®—ç¨³å®šæ€§æ£€æŸ¥
  - ç‰©ç†äº‹ä»¶æ£€æµ‹å’Œå“åº”
  - çŠ¶æ€ç›‘æ§å’Œå¼‚å¸¸å¤„ç†

- **ç»“æœéªŒè¯å±‚** (`SimulationValidator`)
  - é¢˜æ„å¯¹é½æ€§æ£€æŸ¥
  - å®ˆæ’é‡éªŒè¯ï¼ˆèƒ½é‡ã€åŠ¨é‡ï¼‰
  - ç‰©ç†ä¸å˜é‡æ£€æŸ¥

#### **å›æµé‡è·‘æœºåˆ¶**
```typescript
// è‡ªåŠ¨é”™è¯¯æ£€æµ‹å’Œä¿®å¤
class PhysicsFeedback {
  async validateAndOptimize(result, originalDSL) {
    const issues = await this.detectIssues(result);
    if (issues.length > 0) {
      const optimizedDSL = await this.optimizeDSL(originalDSL, issues);
      return await this.retrySimulation(optimizedDSL);
    }
    return result;
  }
}
```

### 2. è§„èŒƒæ€§ (Standardization) ä¿è¯

#### **æ ‡å‡†åŒ–æ•°æ®æµ**
- **ç»Ÿä¸€æ¥å£å®šä¹‰**: æ‰€æœ‰æœåŠ¡å±‚ä½¿ç”¨ä¸€è‡´çš„ TypeScript æ¥å£
- **æ ‡å‡†åŒ–æ ¼å¼**: DSLã€IRã€ä»¿çœŸç»“æœéƒ½éµå¾ªé¢„å®šä¹‰æ ¼å¼
- **å•ä½æ ‡å‡†åŒ–**: é€šè¿‡ `unitConverter` ç»Ÿä¸€åˆ° SI å•ä½åˆ¶

#### **æ•™è‚²æ ‡å‡†éµå¾ª**
- **è¯¾ç¨‹æ ‡å‡†**: ä¸¥æ ¼éµå¾ªåˆä¸­/é«˜ä¸­ç‰©ç†è¯¾ç¨‹æ ‡å‡†
- **çŸ¥è¯†ç‚¹æ˜ å°„**: è‡ªåŠ¨æ˜ å°„åˆ°æ ‡å‡†ç‰©ç†çŸ¥è¯†ç‚¹ä½“ç³»
- **éš¾åº¦åˆ†çº§**: åŸºäºæ•™è‚²æ ‡å‡†è‡ªåŠ¨è¯„ä¼°é¢˜ç›®éš¾åº¦

#### **ä»£ç è§„èŒƒ**
- **TypeScript å¼ºç±»å‹**: 100% ç±»å‹è¦†ç›–ï¼Œç¼–è¯‘æ—¶é”™è¯¯æ£€æŸ¥
- **ESLint è§„èŒƒ**: ç»Ÿä¸€çš„ä»£ç é£æ ¼å’Œè´¨é‡æ ‡å‡†
- **æ¨¡å—åŒ–è®¾è®¡**: æ¸…æ™°çš„èŒè´£åˆ†ç¦»å’Œæ¥å£å®šä¹‰

### 3. å¯æ‰©å±•æ€§ (Scalability) ä¿è¯

#### **æ¨¡å—åŒ–æ¶æ„è®¾è®¡**
```
æ ¸å¿ƒæœåŠ¡å±‚ (Core Services)
â”œâ”€â”€ åŸºç¡€æœåŠ¡ (Base Services)
â”œâ”€â”€ æ‰©å±•æœåŠ¡ (Extension Services)
â””â”€â”€ æ’ä»¶æœåŠ¡ (Plugin Services)
```

- **æ’ä»¶åŒ–è®¾è®¡**: æ”¯æŒç‰©ç†ä¸»é¢˜ã€ä»¿çœŸæ–¹æ³•ã€æ¸²æŸ“æ•ˆæœçš„åŠ¨æ€æ‰©å±•
- **æ¥å£æŠ½è±¡**: é€šè¿‡æŠ½è±¡æ¥å£æ”¯æŒå¤šç§å®ç°æ–¹å¼
- **é…ç½®é©±åŠ¨**: é€šè¿‡é…ç½®æ–‡ä»¶æ§åˆ¶åŠŸèƒ½å¯ç”¨å’Œå‚æ•°è°ƒæ•´

#### **æ°´å¹³æ‰©å±•èƒ½åŠ›**
- **å¾®æœåŠ¡æ¶æ„**: å„æœåŠ¡å±‚å¯ç‹¬ç«‹éƒ¨ç½²å’Œæ‰©å±•
- **è´Ÿè½½å‡è¡¡**: æ”¯æŒå¤šå®ä¾‹éƒ¨ç½²å’Œè´Ÿè½½åˆ†å‘
- **ç¼“å­˜ç­–ç•¥**: Redis ç¼“å­˜æ”¯æŒé«˜é¢‘æ•°æ®å¿«é€Ÿè®¿é—®

#### **å‚ç›´æ‰©å±•èƒ½åŠ›**
- **ç®—æ³•ä¼˜åŒ–**: æ”¯æŒä¸åŒç²¾åº¦çš„ä»¿çœŸç®—æ³•
- **æ¸²æŸ“è´¨é‡**: æ”¯æŒå¤šç§æ¸²æŸ“è´¨é‡å’Œæ€§èƒ½æ¨¡å¼
- **å­˜å‚¨æ‰©å±•**: æ”¯æŒæœ¬åœ°å­˜å‚¨å’Œäº‘ç«¯å­˜å‚¨çš„çµæ´»åˆ‡æ¢

### 4. å¯å¤ç°æ€§ (Reproducibility) ä¿è¯

#### **ç¡®å®šæ€§ä»¿çœŸ**
- **ç§å­æ§åˆ¶**: æ‰€æœ‰éšæœºæ•°ä½¿ç”¨å›ºå®šç§å­ï¼Œç¡®ä¿ç»“æœå¯å¤ç°
- **æ—¶é—´æ­¥é•¿æ§åˆ¶**: ç²¾ç¡®çš„æ—¶é—´æ­¥é•¿æ§åˆ¶ï¼Œé¿å…ç´¯ç§¯è¯¯å·®
- **æ•°å€¼æ–¹æ³•é€‰æ‹©**: æ”¯æŒç¡®å®šæ€§å’Œéšæœºæ€§æ•°å€¼æ–¹æ³•

#### **çŠ¶æ€å¿«ç…§ç³»ç»Ÿ**
```typescript
class SimulationSnapshot {
  // ä¿å­˜ä»¿çœŸçŠ¶æ€
  async saveSnapshot(simulator, timestamp) {
    return {
      timestamp,
      state: simulator.getCurrentState(),
      parameters: simulator.getParameters(),
      checksum: this.calculateChecksum(simulator)
    };
  }
  
  // æ¢å¤ä»¿çœŸçŠ¶æ€
  async restoreSnapshot(snapshot) {
    const simulator = new PhysicsSimulator();
    simulator.setState(snapshot.state);
    simulator.setParameters(snapshot.parameters);
    return simulator;
  }
}
```

#### **ç‰ˆæœ¬æ§åˆ¶**
- **DSL ç‰ˆæœ¬ç®¡ç†**: æ¯ä¸ª DSL éƒ½æœ‰ç‰ˆæœ¬æ ‡è¯†å’Œå˜æ›´è®°å½•
- **ä»¿çœŸå‚æ•°ç‰ˆæœ¬**: è®°å½•ä»¿çœŸå‚æ•°çš„å†å²å˜æ›´
- **ç»“æœç‰ˆæœ¬å…³è”**: ç»“æœä¸è¾“å…¥å‚æ•°çš„ç‰ˆæœ¬å…³è”

#### **ç¯å¢ƒä¸€è‡´æ€§**
- **Docker å®¹å™¨åŒ–**: ç¡®ä¿å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒçš„ä¸€è‡´æ€§
- **ä¾èµ–é”å®š**: ç²¾ç¡®é”å®šæ‰€æœ‰ä¾èµ–ç‰ˆæœ¬
- **é…ç½®ç®¡ç†**: ç¯å¢ƒé…ç½®çš„ç‰ˆæœ¬æ§åˆ¶å’Œä¸€è‡´æ€§æ£€æŸ¥

### 5. å¯ç»´æŠ¤æ€§ (Maintainability) ä¿è¯

#### **æ¸…æ™°çš„ä»£ç ç»“æ„**
```
services/
â”œâ”€â”€ ai_parsing/          # AI è§£ææœåŠ¡
â”œâ”€â”€ dsl/                 # DSL å¤„ç†æœåŠ¡
â”œâ”€â”€ validation/          # éªŒè¯æœåŠ¡
â”œâ”€â”€ simulation/          # ä»¿çœŸæœåŠ¡
â”œâ”€â”€ rendering/           # æ¸²æŸ“æœåŠ¡
â””â”€â”€ testing/             # æµ‹è¯•æœåŠ¡
```

- **å•ä¸€èŒè´£åŸåˆ™**: æ¯ä¸ªæ¨¡å—åªè´Ÿè´£ä¸€ä¸ªç‰¹å®šåŠŸèƒ½
- **ä¾èµ–æ³¨å…¥**: é€šè¿‡æ¥å£è§£è€¦ï¼Œä¾¿äºæµ‹è¯•å’Œæ›¿æ¢
- **é…ç½®å¤–éƒ¨åŒ–**: æ‰€æœ‰é…ç½®å‚æ•°éƒ½å¯é€šè¿‡é…ç½®æ–‡ä»¶è°ƒæ•´

#### **å…¨é¢çš„æµ‹è¯•è¦†ç›–**
- **å•å…ƒæµ‹è¯•**: æ¯ä¸ªæœåŠ¡æ¨¡å—éƒ½æœ‰å®Œæ•´çš„å•å…ƒæµ‹è¯•
- **é›†æˆæµ‹è¯•**: æµ‹è¯•å„æœåŠ¡å±‚ä¹‹é—´çš„åä½œ
- **ç«¯åˆ°ç«¯æµ‹è¯•**: æµ‹è¯•å®Œæ•´çš„ç”¨æˆ·æµç¨‹
- **æ€§èƒ½æµ‹è¯•**: æµ‹è¯•ç³»ç»Ÿçš„æ€§èƒ½å’Œç¨³å®šæ€§

## ğŸ¬ ä¸»æµæ°´çº¿è„šæœ¬ (scripts/run_pipeline.ts) - v3.0.0

### **ä¸€é”®æ‰§è¡Œæµç¨‹**
```typescript
export async function runPipeline(parsedQuestion, tEnd, outPath) {
  // 1. IRè½¬æ¢ï¼šParsedQuestion â†’ DSL + Contract
  const { dsl, contract } = IRConverter.fromParsed(parsedQuestion);
  
  // 2. Pre-Sim Gateï¼šContractç¡¬æ ¡éªŒ
  ContractValidator.assert(contract);
  
  // 3. æ•°å€¼ä»¿çœŸï¼šäº‹ä»¶é©±åŠ¨ç§¯åˆ†
  const trace = await simulate(dsl, contract, tEnd);
  
  // 4. å¿«é€Ÿæ£€æŸ¥ï¼šè½»é‡æ ¡éªŒï¼ˆå¯é€‰ï¼‰
  ResultValidator.quickCheck(trace, contract);
  
  // 5. æ¸²æŸ“é…ç½®ï¼šè‡ªåŠ¨ç”Ÿæˆæœ€ä¼˜é…ç½®
  const cfg = RenderCfgBuilder.from(contract, trace, {fps:30, size:[1920,1080]});
  
  // 6. å¸§é‡é‡‡æ ·ï¼šå›ºå®šå¸§ç‡ + äº‹ä»¶å¯¹é½
  const seq = resample(trace, cfg.fps);
  
  // 7. å¸§æ¸²æŸ“ï¼šPNGåºåˆ—ç”Ÿæˆ
  const pngs = await renderFrames(seq, cfg);
  
  // 8. è§†é¢‘ç¼–ç ï¼šFFmpeg MP4è¾“å‡º
  await encodeMP4("/tmp/frame_%06d.png", outPath, cfg.fps);
  
  // 9. Post-Sim Gateï¼šç¡¬æ ¡éªŒï¼ˆäº‹ä»¶/å®ˆæ’/å½¢çŠ¶ï¼‰
  ResultValidator.acceptance(trace, contract);
  
  return { outPath, stats: trace.stats };
}
```

### **ä½¿ç”¨ç¤ºä¾‹**
```typescript
// åŸºç¡€ä½¿ç”¨
const result = await runPipeline(
  parsedQuestion,           // AIè§£æç»“æœ
  10.0,                    // ä»¿çœŸ10ç§’
  './output/physics.mp4'   // è¾“å‡ºè·¯å¾„
);

// é«˜çº§é…ç½®
const pipeline = new Pipeline({
  tEnd: 15.0,
  fps: 60,
  resolution: [3840, 2160], // 4K
  enableValidation: true
});
```

#### **ç›‘æ§å’Œæ—¥å¿—**
```typescript
class SystemMonitor {
  // æ€§èƒ½ç›‘æ§
  monitorPerformance(service, operation) {
    const startTime = performance.now();
    return {
      start: () => startTime,
      end: () => performance.now() - startTime,
      log: (result) => this.logPerformance(service, operation, result)
    };
  }
  
  // é”™è¯¯ç›‘æ§
  monitorErrors(service, operation) {
    return {
      catch: (error) => this.logError(service, operation, error),
      report: (issue) => this.reportIssue(issue)
    };
  }
}
```

#### **æ–‡æ¡£å’Œæ³¨é‡Š**
- **API æ–‡æ¡£**: å®Œæ•´çš„æ¥å£æ–‡æ¡£å’Œä½¿ç”¨ç¤ºä¾‹
- **æ¶æ„æ–‡æ¡£**: è¯¦ç»†çš„ç³»ç»Ÿæ¶æ„å’Œè®¾è®¡è¯´æ˜
- **ä»£ç æ³¨é‡Š**: å…³é”®ç®—æ³•å’Œä¸šåŠ¡é€»è¾‘çš„è¯¦ç»†æ³¨é‡Š
- **å˜æ›´æ—¥å¿—**: è®°å½•æ‰€æœ‰é‡è¦çš„åŠŸèƒ½å˜æ›´å’Œ bug ä¿®å¤

### 6. è´¨é‡æŒ‡æ ‡ç›‘æ§

#### **æ­£ç¡®æ€§æŒ‡æ ‡**
- **è§£æå‡†ç¡®ç‡**: AI è§£æçš„å‡†ç¡®ç‡ > 95%
- **ä»¿çœŸç²¾åº¦**: æ•°å€¼è®¡ç®—è¯¯å·® < 1%
- **ç‰©ç†ä¸€è‡´æ€§**: å®ˆæ’é‡åå·® < 0.1%

#### **è§„èŒƒæ€§æŒ‡æ ‡**
- **æ ¼å¼è§„èŒƒç‡**: DSL æ ¼å¼è§„èŒƒç‡ > 98%
- **æ ‡å‡†éµå¾ªç‡**: æ•™è‚²æ ‡å‡†éµå¾ªç‡ 100%
- **æ¥å£ä¸€è‡´æ€§**: æ¥å£ä¸€è‡´æ€§ 100%

#### **å¯æ‰©å±•æ€§æŒ‡æ ‡**
- **æ–°ä¸»é¢˜æ·»åŠ æ—¶é—´**: < 2 å°æ—¶
- **æ–°ä»¿çœŸæ–¹æ³•é›†æˆ**: < 1 å¤©
- **æ€§èƒ½æ‰©å±•èƒ½åŠ›**: æ”¯æŒ 10x è´Ÿè½½å¢é•¿

#### **å¯å¤ç°æ€§æŒ‡æ ‡**
- **ç»“æœä¸€è‡´æ€§**: ç›¸åŒè¾“å…¥çš„ç»“æœå·®å¼‚ < 0.01%
- **ç¯å¢ƒä¸€è‡´æ€§**: è·¨ç¯å¢ƒç»“æœå·®å¼‚ < 0.1%
- **ç‰ˆæœ¬å…¼å®¹æ€§**: å‘åå…¼å®¹æ€§ 100%

#### **å¯ç»´æŠ¤æ€§æŒ‡æ ‡**
- **ä»£ç è¦†ç›–ç‡**: æµ‹è¯•è¦†ç›–ç‡ > 90%
- **æ–‡æ¡£å®Œæ•´æ€§**: æ–‡æ¡£è¦†ç›–ç‡ > 95%
- **é—®é¢˜å“åº”æ—¶é—´**: å¹³å‡ä¿®å¤æ—¶é—´ < 4 å°æ—¶

## ğŸš€ æŠ€æœ¯æ ˆ

### åç«¯æœåŠ¡
- **è¯­è¨€**: TypeScript/Node.js
- **æ¶æ„**: æ¨¡å—åŒ–æœåŠ¡æ¶æ„
- **æ•°æ®åº“**: Supabase (PostgreSQL)
- **è®¤è¯**: Supabase Auth

### å‰ç«¯åº”ç”¨
- **æ¡†æ¶**: Next.js + React
- **æ ·å¼**: TailwindCSS
- **3D æ¸²æŸ“**: Three.js
- **ç±»å‹**: TypeScript

### ç‰©ç†å¼•æ“
- **ä»¿çœŸ**: è‡ªç ”ç‰©ç†ä»¿çœŸå™¨
- **æ¸²æŸ“**: Three.js + Canvas
- **å¯¼å‡º**: å¤šç§æ ¼å¼æ”¯æŒ

## ğŸ“š ä½¿ç”¨æŒ‡å—

### 1. å¼€å‘ç¯å¢ƒè®¾ç½®
```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd AI_Ed_SIM

# å®‰è£…ä¾èµ–
npm install

# é…ç½®ç¯å¢ƒå˜é‡
cp frontend/env.example frontend/.env.local

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
cd frontend
npm run dev
```

### 2. æ ¸å¿ƒé“¾è·¯æµ‹è¯•
```typescript
// 1. è§£æé¢˜ç›®
const question = "ä¸€ç‰©ä½“ä»¥åˆé€Ÿåº¦ v0=20 m/s æ–œæŠ›ï¼Œæ±‚æœ€å¤§é«˜åº¦hã€‚";
const parsedQuestion = parseQuestion(question);

// 2. ç”Ÿæˆ DSL
const dsl = physicsDSLGenerator.generateDSL(parsedQuestion);

// 3. æ‰§è¡Œä»¿çœŸ
const simulator = new PhysicsSimulator();
const result = simulator.simulate(dsl);

// 4. æ¸²æŸ“åŠ¨ç”»
const renderer = new PhysicsRenderer();
renderer.render(result);
```

### 3. æ‰©å±•å¼€å‘
- **æ–°å¢ç‰©ç†ä¸»é¢˜**: åœ¨ `TOPIC_RULES` ä¸­æ·»åŠ è§„åˆ™
- **æ–°å¢ä»¿çœŸç±»å‹**: æ‰©å±• `PhysicsSystemType`
- **æ–°å¢æ¸²æŸ“æ•ˆæœ**: åœ¨ `PhysicsRenderer` ä¸­æ·»åŠ æ–¹æ³•

## ğŸ”® æœªæ¥è§„åˆ’

### 1. çŸ­æœŸç›®æ ‡
- å®Œå–„ä»¿çœŸå¼•æ“çš„ç¨³å®šæ€§
- ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½
- å¢åŠ æ›´å¤šç‰©ç†ä¸»é¢˜æ”¯æŒ

### 2. ä¸­æœŸç›®æ ‡
- æ”¯æŒåŒ–å­¦å’Œç”Ÿç‰©ä»¿çœŸ
- æ·»åŠ æœºå™¨å­¦ä¹ ä¼˜åŒ–
- å®ç°äº‘ç«¯ä»¿çœŸæœåŠ¡

### 3. é•¿æœŸç›®æ ‡
- æ„å»ºå®Œæ•´çš„æ•™è‚²ç”Ÿæ€ç³»ç»Ÿ
- æ”¯æŒå¤šè¯­è¨€å›½é™…åŒ–
- å®ç°è·¨å¹³å°éƒ¨ç½²

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- **GitHub Issues**: æäº¤ bug æŠ¥å‘Šå’ŒåŠŸèƒ½è¯·æ±‚
- **æ–‡æ¡£**: æŸ¥çœ‹è¯¦ç»†çš„ API æ–‡æ¡£å’Œä½¿ç”¨æŒ‡å—
- **ç¤¾åŒº**: å‚ä¸å¼€å‘è€…ç¤¾åŒºè®¨è®º

## ğŸ§¹ æ–‡ä»¶æ¶æ„ä¼˜åŒ–å»ºè®® - v3.0.0

### **ğŸ¯ ä¼˜åŒ–ç›®æ ‡**
åŸºäºContract-basedç®¡é“å®Œæˆï¼Œæ¸…ç†é‡å¤æ–‡ä»¶ï¼Œç®€åŒ–å¼€å‘ç»“æ„ã€‚

### **ğŸ“Š å½“å‰é—®é¢˜åˆ†æ**
- **é‡å¤æ–‡ä»¶**: 37ä¸ª.js/.tsé‡å¤æ–‡ä»¶é€ æˆç»´æŠ¤å›°éš¾
- **å†—ä½™ç›®å½•**: 12ä¸ªåµŒå¥—é‡å¤ç›®å½•å½±å“ä»£ç å®šä½
- **è¿‡æ—¶ç»„ä»¶**: 7ä¸ªè¢«v3.0.0æ›¿ä»£çš„æ–‡ä»¶å ç”¨ç©ºé—´

### **ğŸ—‘ï¸ å»ºè®®åˆ é™¤çš„æ–‡ä»¶æ¸…å•**

#### **é‡å¤JavaScriptæ–‡ä»¶ (30ä¸ª)**
```bash
# AIè§£ææ¨¡å—é‡å¤ (4ä¸ª)
rm services/ai_parsing/AtomicModules.js
rm services/ai_parsing/PhysicsAIParser.js
rm services/ai_parsing/PhysicsAIParserAICaller.js
rm services/ai_parsing/unitConverter.js

# æ¸²æŸ“æ¨¡å—é‡å¤ (7ä¸ª)
rm services/rendering/CoordinateSystem.js
rm services/rendering/DynamicPhysicsRenderer.js
rm services/rendering/DynamicVideoGenerator.js
rm services/rendering/Physics2DRenderer.js
rm services/rendering/PhysicsRenderFactory.js
rm services/rendering/RenderingManager.js
rm services/rendering/RenderingStrategy.js

# ä»¿çœŸ/IR/æ ¸å¿ƒæ¨¡å—é‡å¤ (19ä¸ª)
find services/ -name "*.js" -type f | grep -E "(simulation|ir|core|dsl)" | head -19
```

#### **å†—ä½™ç›®å½•ç»“æ„ (12ä¸ª)**
```bash
# åˆ é™¤services/core/ä¸‹çš„é‡å¤ç›®å½•
rm -rf services/core/ai_parsing/
rm -rf services/core/dsl/
rm -rf services/core/ir/
rm -rf services/core/rendering/
rm -rf services/core/simulation/
rm -rf services/core/validation/

# åˆ é™¤services/dsl/ä¸‹çš„é‡å¤ç›®å½•
rm -rf services/dsl/ai_parsing/
rm -rf services/dsl/dsl/

# åˆ é™¤services/simulation/ä¸‹çš„åµŒå¥—ç›®å½•
rm -rf services/simulation/simulation/
rm -rf services/simulation/ir/
```

#### **è¿‡æ—¶åŠŸèƒ½æ–‡ä»¶ (7ä¸ª)**
```bash
# v3.0.0åè¢«æ›¿ä»£çš„æ–‡ä»¶
rm services/engine_bridge/PhysicsEngineBridge.ts
rm services/export/AnimationExporter.ts
rm services/export/PhysicsExporter.ts
rm services/feedback/PhyscisFeedback.ts
rm services/feedback/SimulationValidator.ts
rm services/testing/TestAIParser/test_enhanced_system.js
rm services/testing/TestRendering/test_simulation_to_video.js
```

### **âœ… ä¼˜åŒ–åçš„ç²¾ç®€æ¶æ„**

#### **æ ¸å¿ƒç›®å½•ç»“æ„ (ç²¾ç®€35%)**
```
services/
â”œâ”€â”€ ğŸ“ ai_parsing/              # AIè§£æå±‚ (6ä¸ª.tsæ–‡ä»¶)
â”œâ”€â”€ ğŸ“ ir/                      # IRè½¬æ¢å±‚ (6ä¸ªæ–‡ä»¶)
â”œâ”€â”€ ğŸ“ simulation/              # ä»¿çœŸè®¡ç®—å±‚ (8ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ Simulator.ts            # v3.0.0æ ¸å¿ƒ
â”‚   â”œâ”€â”€ integrators/            # RK4/RK45
â”‚   â””â”€â”€ events/                 # äº‹ä»¶æ ¹å®šä½+æ¥è§¦å†²é‡
â”œâ”€â”€ ğŸ“ rendering/               # æ¸²æŸ“å±‚ (11ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ RenderCfgBuilder.ts     # v3.0.0æ ¸å¿ƒ
â”‚   â”œâ”€â”€ CanvasFrameRenderer.ts  # v3.0.0æ ¸å¿ƒ
â”‚   â””â”€â”€ FrameResampler.ts       # v3.0.0æ ¸å¿ƒ
â”œâ”€â”€ ğŸ“ validation/              # éªŒè¯å±‚ (3ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ ResultValidator.ts      # Post-Sim Gate
â”‚   â””â”€â”€ AcceptanceRunner.ts     # æ–­è¨€æ‰§è¡Œå™¨
â”œâ”€â”€ ğŸ“ export/                  # å¯¼å‡ºå±‚ (2ä¸ªæ–‡ä»¶)
â”‚   â””â”€â”€ FFmpegEncoder.ts        # v3.0.0æ ¸å¿ƒ
â”œâ”€â”€ ğŸ“ feedback/                # åé¦ˆå±‚ (2ä¸ªæ–‡ä»¶)
â”œâ”€â”€ ğŸ“ core/                    # æ ¸å¿ƒæ¥å£å±‚ (2ä¸ªæ–‡ä»¶)
â”œâ”€â”€ ğŸ“ dsl/                     # DSLå±‚ (1ä¸ªæ–‡ä»¶)
â””â”€â”€ ğŸ“ testing/                 # æµ‹è¯•å±‚ (ä¿æŒç°çŠ¶)
```

### **ğŸš€ ä¼˜åŒ–æ•ˆæœ**
- **æ–‡ä»¶æ•°é‡**: 107ä¸ª â†’ 70ä¸ª (-35%)
- **ç›®å½•å±‚çº§**: æ›´æ¸…æ™°çš„å±‚æ¬¡ç»“æ„
- **ç»´æŠ¤æˆæœ¬**: æ˜¾è‘—é™ä½
- **å¼€å‘æ•ˆç‡**: æ›´å®¹æ˜“å®šä½å’Œä¿®æ”¹ä»£ç 

---

**ğŸ“… æ–‡æ¡£ç‰ˆæœ¬**: v3.0.0 (2025å¹´1æœˆ)  
**ğŸ¯ ç³»ç»ŸçŠ¶æ€**: ç”Ÿäº§å°±ç»ª (100%å®Œæˆåº¦)  
**ğŸ† æŠ€æœ¯ç­‰çº§**: å·¥ä¸šçº§Contract-basedç‰©ç†ä»¿çœŸå¹³å°

*æœ¬æ–‡æ¡£æŒç»­æ›´æ–°ï¼Œè¯·å…³æ³¨æœ€æ–°ç‰ˆæœ¬*
